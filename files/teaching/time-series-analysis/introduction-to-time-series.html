<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.26">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Natasha Kang">

<title>Introduction to Time Series</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="unit1_files/libs/clipboard/clipboard.min.js"></script>
<script src="unit1_files/libs/quarto-html/quarto.js" type="module"></script>
<script src="unit1_files/libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="unit1_files/libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="unit1_files/libs/quarto-html/popper.min.js"></script>
<script src="unit1_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="unit1_files/libs/quarto-html/anchor.min.js"></script>
<link href="unit1_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="unit1_files/libs/quarto-html/quarto-syntax-highlighting-587c61ba64f3a5504c4d52d930310e48.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="unit1_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="unit1_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="unit1_files/libs/bootstrap/bootstrap-d6a003b94517c951b2d65075d42fb01b.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="quarto-light">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
<div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="introduction-to-time-series.html"><i class="bi bi-file-slides"></i>RevealJS</a></li></ul></div></div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Introduction to Time Series</h1>
<p class="subtitle lead">What Makes Time Series Special?</p>
</div>


<div class="quarto-title-meta-author">
  <div class="quarto-title-meta-heading">Author</div>
  <div class="quarto-title-meta-heading">Affiliation</div>
  
    <div class="quarto-title-meta-contents">
    <p class="author">Natasha Kang </p>
  </div>
  <div class="quarto-title-meta-contents">
        <p class="affiliation">
            Xiamen University, Chow Institute
          </p>
      </div>
  </div>

<div class="quarto-title-meta">

      
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">January, 2026</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="what-is-a-time-series" class="level2">
<h2 class="anchored" data-anchor-id="what-is-a-time-series">What Is a Time Series?</h2>
<p>A <strong>time series</strong> is a sequence of observations indexed in time:</p>
<p><span class="math display">\[
x_1, x_2, \ldots, x_T
\]</span></p>
<p>Examples:</p>
<ul>
<li>Monthly airline passengers</li>
<li>Atmospheric CO₂</li>
<li>Quarterly GDP</li>
<li>Daily stock returns</li>
</ul>
<p><strong>Ordering in time matters!</strong></p>
</section>
<section id="time-series-vs-cross-sectional-data" class="level2">
<h2 class="anchored" data-anchor-id="time-series-vs-cross-sectional-data">Time Series vs Cross-Sectional Data</h2>
<div class="columns">
<div class="column">
<p><strong>Cross-Sectional Data</strong></p>
<div id="cell-fig-cross" class="cell" data-execution_count="1">
<div class="cell-output cell-output-display">
<div id="fig-cross" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-cross-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="unit1_files/figure-html/fig-cross-output-1.png" width="420" height="420" class="figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-cross-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: Cross-sectional data: order does not matter
</figcaption>
</figure>
</div>
</div>
</div>
</div><div class="column">
<p><strong>Time Series Data</strong></p>
<div id="cell-fig-ts" class="cell" data-execution_count="2">
<div class="cell-output cell-output-display">
<div id="fig-ts" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ts-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="unit1_files/figure-html/fig-ts-output-1.png" width="420" height="420" class="figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ts-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2: Time series: order matters
</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="cross-sectional-data-reminder" class="level2">
<h2 class="anchored" data-anchor-id="cross-sectional-data-reminder">Cross-Sectional Data: Reminder</h2>
<p>Cross-sectional data consist of <strong>multiple units observed at one point in time</strong><br>
(e.g., households, firms, individuals, countries).</p>
<p>A key modeling assumption is that the data come from random variables:</p>
<p><span class="math display">\[
X_1, X_2, \ldots, X_n \quad \text{ i.i.d.}
\]</span></p>
<p><strong>Why i.i.d.?</strong></p>
<ul>
<li><strong>Independence</strong>: one unit’s outcome does not affect another’s<br>
</li>
<li><strong>Identical distribution</strong>: all units share the same distribution</li>
</ul>
<p>These assumptions are reasonable when the dataset is a<br>
<strong>collection of different units</strong> — reshuffling dataset changes nothing.</p>
</section>
<section id="why-i.i.d.-fails-for-time-series" class="level2">
<h2 class="anchored" data-anchor-id="why-i.i.d.-fails-for-time-series">Why i.i.d. Fails for Time Series</h2>
<p>Time series track <strong>the same unit over time</strong>:</p>
<p><span class="math display">\[
x_1, x_2, \ldots, x_T
\]</span></p>
<p>This breaks the usual cross-sectional assumptions:</p>
<ul>
<li><p><strong>Not independent:</strong><br>
past values typically influence future values</p></li>
<li><p><strong>Not identically distributed:</strong><br>
levels, variance, or dynamics may evolve over time</p></li>
<li><p><strong>Order matters:</strong><br>
reshuffling destroys patterns, dependence, trends, or cycles</p></li>
</ul>
<p>Therefore, we need a more general probabilistic framework that accommodates ordered data and systematic dependence across time.</p>
</section>
<section id="stochastic-processes" class="level2">
<h2 class="anchored" data-anchor-id="stochastic-processes">Stochastic Processes</h2>
<p>To model ordered data with possible dependence, we treat a time series as a realization of a <strong>stochastic process</strong>.</p>
<p>A stochastic process is a collection of random variables:</p>
<p><span class="math display">\[
\{ X_t : t \in \mathbb{T} \},
\]</span> where <span class="math inline">\(\mathbb{T}\)</span> is an ordered index set (e.g., time).</p>
<p>The observed series is one realization:</p>
<p><span class="math display">\[
x_t = X_t(\omega), \qquad t = 1, \ldots, T.
\]</span></p>
<p>Modeling the data as a stochastic process allows us to describe the <strong>joint distribution</strong> of the sequence <span class="math inline">\(\{X_t\}\)</span>, and therefore to capture dependence across time.</p>
</section>
<section id="nature-of-time-series-data" class="level2">
<h2 class="anchored" data-anchor-id="nature-of-time-series-data">Nature of Time Series Data</h2>
<div id="35cbdf37" class="cell" data-execution_count="3">
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="unit1_files/figure-html/cell-4-output-1.png" class="quarto-figure quarto-figure-center figure-img" width="420" height="420"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="from-data-to-a-statistical-model" class="level2">
<h2 class="anchored" data-anchor-id="from-data-to-a-statistical-model">From Data to a Statistical Model</h2>
<p>The primary goal of time series analysis is to develop statistical models that provide plausible descriptions of data.</p>
<p>In practice, this means specifying a <strong>joint distribution</strong> for <span class="math inline">\((X_1, \ldots, X_T)\)</span> through simple, structured models, such as:</p>
<ul>
<li><p><strong>White noise</strong><br>
(no dependence across time)</p></li>
<li><p><strong>Moving average models</strong><br>
(dependence driven by past shocks)</p></li>
<li><p><strong>Autoregressive models</strong><br>
(dependence driven by past values)</p></li>
<li><p><strong>Random walks and trends</strong><br>
(persistent or nonstationary behavior)</p></li>
<li><p><strong>Models with time-varying variance</strong><br>
(changing volatility over time)</p></li>
</ul>
<p>These models serve as building blocks for more general specifications.</p>
</section>
<section id="measures-of-dependence" class="level2">
<h2 class="anchored" data-anchor-id="measures-of-dependence">Measures of Dependence</h2>
<p>In principle, a time series is completely described by the joint distribution of ((X_1, , X_T)):</p>
<p><span class="math display">\[
F_{t_1,\dots,t_n}(c_1,\dots,c_n)
=
\Pr(X_{t_1} \le c_1,\dots,X_{t_n} \le c_n).
\]</span></p>
<p>In practice, specifying and working with such joint distributions becomes increasingly difficult as the dimension (n) grows.</p>
<div class="fragment">
<p>Instead, we look at the marginal distribution function: <span class="math display">\[
F_t(x) = \Pr(X_t \le x).
\]</span> or the corresponding marginal density function: <span class="math display">\[
f_t(x) = \frac{\partial F_t(x)}{\partial(x)}
\]</span></p>
</div>
<div class="fragment">
<p>Another informative marginal descriptive measure is the <strong>mean function</strong>, defined as <span class="math display">\[
\mu_t = \mathbb{E}[X_t]
      = \int_{-\infty}^{\infty} x \, f_t(x)\, dx,
\]</span> provided it exists.</p>
</div>
<div class="fragment">
<p>Temporal dependence is described by second-order moments. The <strong>autocovariance function</strong>, provided it exists, is defined as</p>
<p><span class="math display">\[
\gamma(s,t)
=
\operatorname{Cov}(X_s, X_t)
=
\mathbb{E}\!\left[(X_s-\mu_s)(X_t-\mu_t)\right].
\]</span></p>
<p>For <span class="math inline">\(s=t\)</span>, the autocovariance reduces to the variance: <span class="math display">\[
\gamma(t,t) = \operatorname{Var}(X_t).
\]</span></p>
<p>For linear combinations, if <span class="math inline">\(U=\sum_j^m a_j X_j\)</span> and <span class="math inline">\(V=\sum_k^r b_k Y_k\)</span>, then <span class="math display">\[
\operatorname{Cov}(U,V)
=
\sum_j^m \sum_k^r a_j b_k \operatorname{Cov}(X_j,Y_k).
\]</span></p>
</div>
</section>
<section id="examples" class="level2 scrollable">
<h2 class="scrollable anchored" data-anchor-id="examples">Examples</h2>
<ul>
<li>A time series <span class="math inline">\(\{w_t\}\)</span> is called <strong>white noise</strong> if</li>
</ul>
<p><span class="math display">\[
\mathbb{E}(w_t) = 0,
\qquad
\operatorname{Var}(w_t) = \sigma_w^2,
\]</span></p>
<p>and</p>
<p><span class="math display">\[
\operatorname{Cov}(w_t, w_s) = 0
\quad \text{for } t \neq s.
\]</span></p>
<p><em>White noise is the most basic building block in time series analysis</em></p>
<div class="fragment">
<ul>
<li><strong>Moving Average Series</strong></li>
</ul>
<p><span class="math display">\[
x_t = \tfrac{1}{3}\big(w_{t-1} + w_t + w_{t+1}\big)
\]</span></p>
<p>Mean: <span class="math display">\[
\mu_t = \mathbb{E}(x_t) = 0.
\]</span></p>
<p>Autocovariance?</p>
</div>
<div class="fragment">
<ul>
<li><strong>Random Walk with Drift</strong></li>
</ul>
<p><span class="math display">\[
x_t = \delta t + \sum_{j=1}^{t} w_j
\]</span></p>
<p>Mean: <span class="math display">\[
\mu_t = \mathbb{E}(x_t) = \delta t.
\]</span></p>
<p>Autocovariance: <span class="math display">\[
\gamma(s,t) = \operatorname{Cov}(x_s,x_t)
= \sigma_w^2 \min(s,t).
\]</span></p>
</div>
<div class="fragment">
<ul>
<li><strong>Signal Plus Noise</strong></li>
</ul>
<p><span class="math display">\[
x_t = s_t + w_t,
\qquad s_t \text{ deterministic}.
\]</span></p>
<p>Mean: <span class="math display">\[
\mu_t = \mathbb{E}(x_t) = s_t.
\]</span></p>
<p>Autocovariance: <span class="math display">\[
\gamma(s,t) = \operatorname{Cov}(x_s,x_t)
= \sigma_w^2 \mathbf{1}\{s=t\}.
\]</span></p>
</div>
</section>
<section id="measures-of-dependence-1" class="level2">
<h2 class="anchored" data-anchor-id="measures-of-dependence-1">Measures of Dependence</h2>
<p>As in classical statistics, it is more convenient to work with scaled measures of association between <span class="math inline">\(-1\)</span> and <span class="math inline">\(1\)</span>.</p>
<div class="fragment">
<p>The <strong>autocorrelation function (ACF)</strong> is defined as <span class="math display">\[
\rho(s,t)
=
\frac{\gamma(s,t)}
{\sqrt{\gamma(s,s)\,\gamma(t,t)}},
\]</span> provided the variances are finite.</p>
</div>
<div class="fragment">
<p>For two series <span class="math inline">\(\{X_t\}\)</span> and <span class="math inline">\(\{Y_t\}\)</span>, the <strong>cross-covariance function</strong> is <span class="math display">\[
\gamma_{XY}(s,t)
=
\operatorname{Cov}(X_s,Y_t)  =
\mathbb{E}\!\left[(X_s-\mu_{Xs})(Y_t-\mu_{Yt})\right],
\]</span> with corresponding <strong>cross-correlation</strong> <span class="math display">\[
\rho_{XY}(s,t)
=
\frac{\gamma_{XY}(s,t)}
{\sqrt{\gamma_X(s,s)\,\gamma_Y(t,t)}}.
\]</span></p>
</div>
<div class="fragment">
<p>For a multivariate time series <span class="math inline">\((X_{1t},\ldots,X_{rt})\)</span>, <span class="math display">\[
\gamma_{jk}(s,t)
=
\operatorname{Cov}(X_{js},X_{kt}),
\qquad j,k=1,\ldots,r.
\]</span></p>
</div>
<div class="fragment">
<p>In general, these quantities may depend on both <span class="math inline">\(s\)</span> and <span class="math inline">\(t\)</span>. When they depend only on the separation <span class="math inline">\(|t-s|\)</span>, this leads to the notion of <strong>stationarity</strong>.</p>
</div>
</section>
<section id="stationary-time-series" class="level2">
<h2 class="anchored" data-anchor-id="stationary-time-series">Stationary Time Series</h2>
<p>A time series <span class="math inline">\(\{X_t\}\)</span> is <strong>strictly stationary</strong> if, for all <span class="math inline">\(t_1,\ldots,t_n\)</span> and all time shifts <span class="math inline">\(h\)</span>,</p>
<p><span class="math display">\[
(X_{t_1},\ldots,X_{t_n})
\overset{d}{=}
(X_{t_1+h},\ldots,X_{t_n+h}),
\]</span></p>
<p>that is, all finite-dimensional distributions are invariant to time shifts.</p>
<p><br></p>
<div class="fragment">
<section id="implications-of-strict-stationarity" class="level3">
<h3 class="anchored" data-anchor-id="implications-of-strict-stationarity">Implications of Strict Stationarity:</h3>
<ul>
<li>If the mean function exists, strict stationarity implies</li>
</ul>
<p><span class="math display">\[
\mu_s=\mu_t=\mu.
\]</span></p>
<ul>
<li>If the variance exists, the autocovariance satisfies</li>
</ul>
<p><span class="math display">\[
\gamma(s,t)=\gamma(s+h,t+h)
\quad \text{for all } s,t,h.
\]</span> Hence,</p>
<p><span class="math display">\[
\gamma(s,t)=\gamma(t-s).
\]</span></p>
</section>
</div>
</section>
<section id="stationary-time-series-1" class="level2">
<h2 class="anchored" data-anchor-id="stationary-time-series-1">Stationary Time Series</h2>
<p>A time series <span class="math inline">\(\{X_t\}\)</span> is <strong>weakly stationary</strong> if</p>
<ul>
<li>the mean is constant:</li>
</ul>
<p><span class="math display">\[
\mathbb{E}(X_t) = \mu;
\]</span></p>
<ul>
<li>the autocovariance depends only on the lag:</li>
</ul>
<p><span class="math display">\[
\gamma(s,t) = \gamma(t-s).
\]</span></p>
<p><br></p>
<div class="fragment">
<p>Under weak stationarity, the <strong>autocovariance function</strong> can be written as</p>
<p><span class="math display">\[
\gamma(h)
=
\operatorname{Cov}(X_{t+h},X_t)
=
\mathbb{E}\!\left[(X_{t+h}-\mu)(X_t-\mu)\right].
\]</span></p>
</div>
<div class="fragment">
<p>The corresponding <strong>autocorrelation function (ACF)</strong> is</p>
<p><span class="math display">\[
\rho(h)
=
\frac{\gamma(t+h,t)}
{\sqrt{\gamma(t+h,t+h)\,\gamma(t,t)}}
=
\frac{\gamma(h)}{\gamma(0)}.
\]</span></p>
</div>
<div class="fragment">
<p><strong>Exercise (Concept Check).</strong> Show that the autocorrelation function satisfies <span class="math display">\[
-1 \le \rho(h) \le 1
\quad \text{for all } h.
\]</span></p>
<p>Hint: By Cauchy–Schwarz inequality,</p>
<p><span class="math display">\[
\big|\mathbb{E}[UV]\big|
\;\le\;
\sqrt{\mathbb{E}[U^2]\mathbb{E}[V^2]},
\]</span></p>
</div>
</section>
<section id="examples-1" class="level2 scrollable">
<h2 class="scrollable anchored" data-anchor-id="examples-1">Examples</h2>
<ul>
<li><strong>White noise</strong>: <span class="math inline">\(\{w_t\}\)</span></li>
</ul>
<p><span class="math display">\[
\mathbb{E}(w_t)=0,
\qquad
\operatorname{Var}(w_t)=\sigma_w^2,
\qquad
\operatorname{Cov}(w_t,w_s)=0 \ (t\neq s).
\]</span></p>
<div class="fragment">
<ul>
<li><p><strong>Moving average</strong>: <span class="math inline">\(x_t = \tfrac{1}{3}\big(w_{t-1} + w_t + w_{t+1}\big)\)</span></p>
<ul>
<li>Mean:</li>
</ul>
<p><span class="math display">\[
\mu_t = 0.
\]</span></p>
<ul>
<li>Autocovariance:</li>
</ul></li>
</ul>
<p><span class="math display">\[
\gamma_v(h)=
\begin{cases}
\tfrac{3}{9}\sigma_w^2, &amp; h=0,\\
\tfrac{2}{9}\sigma_w^2, &amp; h=\pm1,\\
\tfrac{1}{9}\sigma_w^2, &amp; h=\pm2,\\
0, &amp; |h|&gt;2.
\end{cases}
\]</span></p>
</div>
<div class="fragment">
<ul>
<li><strong>Random walk with drift</strong>: <span class="math inline">\(x_t = \delta t + \sum_{j=1}^t w_j\)</span></li>
</ul>
</div>
<div class="fragment">
<ul>
<li><strong>Trend stationary</strong>: <span class="math inline">\(x_t = \alpha + \beta t + y_t\)</span>, <span class="math inline">\(y_t\)</span> is weakly stationary.
<ul>
<li><p>Mean: <span class="math display">\[
\mu_{x,t} = \alpha + \beta t + \mu_{y}
\]</span></p></li>
<li><p>Autocovariance: <span class="math display">\[
\gamma_x(h)=\gamma_y(h).
\]</span></p></li>
</ul></li>
</ul>
</div>
</section>
<section id="jointly-stationary-time-series" class="level2">
<h2 class="anchored" data-anchor-id="jointly-stationary-time-series">Jointly Stationary Time Series</h2>
<p>Let <span class="math inline">\(\{X_t\}\)</span> and <span class="math inline">\(\{Y_t\}\)</span> be two time series.</p>
<p>They are said to be <strong>jointly (weakly) stationary</strong> if both <span class="math inline">\(\{X_t\}\)</span> and <span class="math inline">\(\{Y_t\}\)</span> are weakly stationary, and the <strong>cross-covariance</strong></p>
<p><span class="math display">\[
\gamma_{XY}(h)
=
\operatorname{Cov}(X_{t+h},Y_t)
=
\mathbb{E}\!\left[(X_{t+h}-\mu_X)(Y_t-\mu_Y)\right].
\]</span> depends only on the lag <span class="math inline">\(h\)</span>.</p>
<p><br></p>
<div class="fragment">
<p>The corresponding <strong>cross-correlation function (CCF)</strong> is <span class="math display">\[
\rho_{XY}(h)
=
\frac{\gamma_{XY}(h)}
{\sqrt{\gamma_X(0)\,\gamma_Y(0)}}.
\]</span></p>
</div>
<p><br></p>
<div class="fragment">
<p><strong>Exercise.</strong> Show that <span class="math inline">\(\rho_{XY}(h) = \rho_{YX}(-h)\)</span></p>
</div>
</section>
<section id="prediction-using-cross-correlation" class="level2">
<h2 class="anchored" data-anchor-id="prediction-using-cross-correlation">Prediction Using Cross-Correlation</h2>
<p>Consider two jointly stationary series <span class="math inline">\(\{x_t\}\)</span> and <span class="math inline">\(\{y_t\}\)</span> related by <span class="math display">\[
y_t = A x_{t-\ell} + w_t,
\]</span> where <span class="math inline">\(w_t\)</span> is noise uncorrelated with <span class="math inline">\(\{x_t\}\)</span>.</p>
<div class="fragment">
<ul>
<li>If <span class="math inline">\(\ell &gt; 0\)</span>, then <span class="math inline">\(x_t\)</span> <strong>leads</strong> <span class="math inline">\(y_t\)</span>;<br>
</li>
<li>if <span class="math inline">\(\ell &lt; 0\)</span>, then <span class="math inline">\(x_t\)</span> <strong>lags</strong> <span class="math inline">\(y_t\)</span>.</li>
</ul>
</div>
<div class="fragment">
<p>The cross-covariance satisfies <span class="math display">\[
\begin{aligned}
\gamma_{yx}(h)
&amp;= \operatorname{Cov}(y_{t+h}, x_t) \\
&amp;= \operatorname{Cov}(A x_{t+h-\ell} + w_{t+h}, x_t) \\
&amp;= A\,\gamma_x(h-\ell).
\end{aligned}
\]</span></p>
</div>
<div class="fragment">
<p>Hence, <span class="math inline">\(\gamma_{yx}(h)\)</span> peaks at <span class="math inline">\(h=\ell\)</span> (Why?)</p>
</div>
<div class="fragment">
<div id="fc0b0884" class="cell" data-execution_count="4">
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="unit1_files/figure-html/cell-5-output-1.png" class="quarto-figure quarto-figure-center figure-img" width="420" height="420"></p>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="linear-processes" class="level2">
<h2 class="anchored" data-anchor-id="linear-processes">Linear Processes</h2>
<p>A time series <span class="math inline">\(\{x_t\}\)</span> is called a <strong>linear process</strong> if it can be written as</p>
<p><span class="math display">\[
x_t = \mu + \sum_{j=-\infty}^{\infty} \psi_j \, w_{t-j}, \quad \sum_{j=-\infty}^{\infty} |\psi_j| &lt; \infty.
\]</span> where <span class="math inline">\(\{w_t\}\)</span> is white noise.</p>
<p><br></p>
<div class="fragment">
<p>Its autocovariance function is given by</p>
<p><span class="math display">\[
\gamma_x(h) = \sigma^2_\omega \sum_{j=-\infty}^{\infty} \psi_{j+h} \psi_j
\]</span> for <span class="math inline">\(h\geq 0\)</span>.</p>
<p><em>For the existence of finite second moments, it is sufficient to assume <span class="math inline">\(\sum_{j=-\infty}^{\infty} \psi_j^2 &lt; \infty\)</span>.</em></p>
</div>
</section>
<section id="gaussian-processes" class="level2">
<h2 class="anchored" data-anchor-id="gaussian-processes">Gaussian Processes</h2>
<p>A process <span class="math inline">\(\{x_t\}\)</span> is called a <strong>Gaussian process</strong> if, for every collection of distinct time points <span class="math inline">\(t_1, t_2, \ldots, t_n\)</span> and every <span class="math inline">\(n\)</span>, the random vector <span class="math display">\[
(x_{t_1}, x_{t_2}, \ldots, x_{t_n})
\]</span> has a multivariate normal distribution.</p>
<p><br></p>
<div class="fragment">
<p>For a Gaussian process, the joint distribution is completely characterized by the mean function <span class="math inline">\(\mu = (\mu_{t_1}, \mu_{t_2}, \ldots, \mu_{t_n})\)</span> and the covariance matrix <span class="math inline">\(\Gamma = \{\gamma(t_i,t_j); i,j = 1, \ldots, n\}\)</span>.</p>
<p>The multivariate normal density function can be written as</p>
<p><span class="math display">\[
f(x)
=
(2\pi)^{-n/2} |\Gamma|^{-1/2}
\exp\!\left\{
-\tfrac12 (x-\mu)' \Gamma^{-1} (x-\mu)
\right\}.
\]</span></p>
</div>
<p><br></p>
<div class="fragment">
<ul>
<li>If <span class="math inline">\(x_t = \mu + \sum_{j=-\infty}^{\infty} \psi_j w_{t-j}\)</span> is a linear process with Gaussian white noise <span class="math inline">\(w_t \sim \mathbb{N}(0,\sigma_w^2)\)</span>, then <span class="math inline">\({x_t}\)</span> is a <strong>linear Gaussian process</strong>.</li>
</ul>
</div>
</section>
<section id="from-population-quantities-to-sample-estimates" class="level2">
<h2 class="anchored" data-anchor-id="from-population-quantities-to-sample-estimates">From Population Quantities to Sample Estimates</h2>
<p>In time series analysis, we observe a single realization</p>
<p><span class="math display">\[
x_{t_1}, x_{t_2}, \ldots, x_{t_n},
\]</span> of a stochastic process <span class="math display">\[
\{X_t : t \in \mathbb{T}\}.
\]</span></p>
<ul>
<li>The collection <span class="math inline">\(\{X_t\}\)</span> consists of distinct random variables indexed by time, and possible dependence across time.</li>
</ul>
<div class="fragment">
<ul>
<li>From a classical statistics perspective, estimation is difficult because we do not observe independent replications of the process.</li>
</ul>
</div>
<div class="fragment">
<ul>
<li>Without additional structure, even basic quantities such as the mean <span class="math inline">\(\mu_t\)</span> may vary over time and are not meaningful targets of estimation.</li>
</ul>
</div>
<p><br></p>
<div class="fragment centered">
<p>Hence, we impose <strong>stationarity</strong>!</p>
</div>
</section>
<section id="moments-estimation" class="level2">
<h2 class="anchored" data-anchor-id="moments-estimation">Moments Estimation</h2>
<p>Under stationarity, <span class="math inline">\(\mu_t = \mu\)</span> is constant and we can estimate it by the <em>sample mean</em></p>
<p><span class="math display">\[
\bar{x} = \frac{1}{n} \sum_{t=1}^{n} x_t.
\]</span></p>
<p>The variance of sample mean is given by</p>
<p><span class="math display">\[
\begin{aligned}
\operatorname{Var}(\bar{x})
&amp;= \operatorname{Var}\!\left(\frac{1}{n}\sum_{t=1}^n x_t\right) \\
&amp;= \frac{1}{n^2}\operatorname{Cov}\!\left(\sum_{t=1}^n x_t,\ \sum_{s=1}^n x_s\right) \\
&amp;= \frac{1}{n^2}
\Big(
n\gamma_x(0) + (n-1)\gamma_x(1) + (n-2)\gamma_x(2) + \cdots + \gamma_x(n-1) \\
&amp;\qquad\quad
+ (n-1)\gamma_x(-1) + (n-2)\gamma_x(-2) + \cdots + \gamma_x(1-n)
\Big) \\
&amp;= \frac{1}{n}\sum_{h=-n}^{n}
\left(1-\frac{|h|}{n}\right)\gamma_x(h).
\end{aligned}
\]</span></p>
</section>
<section id="moments-estimation-1" class="level2">
<h2 class="anchored" data-anchor-id="moments-estimation-1">Moments Estimation</h2>
<p>The <strong>sample autocovariance function</strong> is defined as</p>
<p><span class="math display">\[
\hat{\gamma}(h)
=
\frac{1}{n}
\sum_{t=1}^{n-h}
(x_{t+h}-\bar{x})(x_t-\bar{x}),
\qquad h=0,1,\ldots,n-1,
\]</span></p>
<p>with <span class="math display">\[
\hat{\gamma}(-h)=\hat{\gamma}(h).
\]</span></p>
<p><br></p>
<div class="fragment">
<p><strong>Note.</strong> The estimator <span class="math inline">\(\hat{\gamma}(h)\)</span> is <strong>not unbiased</strong> for <span class="math inline">\(\gamma(h)\)</span> in finite samples. However, it has an important structural property: <strong>non-negative definiteness</strong></p>
<ul>
<li>For any constants <span class="math inline">\(a_1,\ldots,a_n\)</span>, the population quadratic form satisfies</li>
</ul>
<p><span class="math display">\[
\operatorname{Var}\!\left(\sum_{t=1}^n a_t X_t\right)
=
\sum_{j=1}^n \sum_{k=1}^n a_j a_k \,\gamma(j-k)
\;\ge\;0.
\]</span></p>
<p>The <strong>sample analogue</strong> replaces <span class="math inline">\(\gamma(\cdot)\)</span> by <span class="math inline">\(\hat\gamma(\cdot)\)</span> and defines</p>
<p><span class="math display">\[
Q_n(a)
\;\equiv\;
\sum_{j=1}^n \sum_{k=1}^n a_j a_k \,\hat{\gamma}(j-k)
=
a^\top \hat{\Gamma} a,
\qquad
\hat{\Gamma}=\big(\hat{\gamma}(j-k)\big)_{j,k}.
\]</span></p>
<p>With the <span class="math inline">\(1/n\)</span> normalization above,</p>
<p><span class="math display">\[
Q_n(a)
=
\frac{1}{n}\sum_{s=1}^n
\left(
\sum_{t=1}^n a_t \,(x_{t+s}-\bar x)
\right)^2
\;\ge\;0,
\]</span></p>
<p>so <span class="math inline">\(\hat{\Gamma}\)</span> is <strong>non-negative definite</strong>.</p>
<p>This guarantee may fail if <span class="math inline">\(\hat{\gamma}(h)\)</span> is defined using <span class="math inline">\(1/(n-h)\)</span> instead of <span class="math inline">\(1/n\)</span>.</p>
</div>
<p><br></p>
<div class="fragment">
<p>The <strong>sample autocorrelation function</strong> is defined as</p>
<p><span class="math display">\[
\hat{\rho}(h)= \frac{\hat \gamma(h)}{\hat \gamma(0)}
\]</span></p>
</div>
</section>
<section id="sample-acf-under-no-dependence" class="level2">
<h2 class="anchored" data-anchor-id="sample-acf-under-no-dependence">Sample ACF Under No Dependence</h2>
<p>Even when a time series has <strong>no autocorrelation</strong>, its sample ACF will generally <strong>not be zero</strong>.</p>
<div id="010be4ba" class="cell" data-fig-height="4" data-execution_count="5">
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="unit1_files/figure-html/cell-6-output-1.png" class="quarto-figure quarto-figure-center figure-img" width="420" height="420"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="sampling-variability-of-the-acf-white-noise" class="level2">
<h2 class="anchored" data-anchor-id="sampling-variability-of-the-acf-white-noise">Sampling Variability of the ACF (White Noise)</h2>
<p>For a white noise process <span class="math inline">\(\{x_t\}\)</span>, and for any fixed lag <span class="math inline">\(h&gt;0\)</span>,</p>
<p><span class="math display">\[
\hat\rho_x(h)
\;\approx\;
\mathrm N\!\left(0,\; \frac{1}{n}\right)
\qquad \text{for large } n.
\]</span></p>
<p><br></p>
<div class="fragment">
<p>As a practical rule of thumb,</p>
<p><span class="math display">\[
\Pr\!\left(\,|\hat\rho(h)| \le \frac{2}{\sqrt{n}}\,\right)
\;\approx\; 0.95.
\]</span></p>
</div>
<p><br></p>
<div class="fragment">
<p>The dashed lines in the ACF plot correspond to <span class="math display">\[
\pm \frac{2}{\sqrt{n}}.
\]</span></p>
<p>Sample autocorrelations outside these bounds are unlikely to arise from white noise.</p>
</div>
</section>
<section id="example-acf-of-a-speech-signal" class="level2">
<h2 class="anchored" data-anchor-id="example-acf-of-a-speech-signal">Example: ACF of a Speech Signal</h2>
<div id="d90cfc82" class="cell" data-fig-height="4" data-execution_count="6">
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="unit1_files/figure-html/cell-7-output-1.png" class="quarto-figure quarto-figure-center figure-img" width="420" height="420"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="sample-cross-covariance-and-cross-correlation" class="level2">
<h2 class="anchored" data-anchor-id="sample-cross-covariance-and-cross-correlation">Sample Cross-Covariance and Cross-Correlation</h2>
<p>Let <span class="math inline">\(\{x_t\}\)</span> and <span class="math inline">\(\{y_t\}\)</span> be two observed time series with sample means <span class="math inline">\(\bar x\)</span> and <span class="math inline">\(\bar y\)</span>.</p>
<p>The <strong>sample cross-covariance function</strong> is defined as</p>
<p><span class="math display">\[
\hat\gamma_{xy}(h)
=
\frac{1}{n}
\sum_{t=1}^{n-h}
(x_{t+h}-\bar x)(y_t-\bar y),
\qquad h = 0,1,\ldots,n-1.
\]</span></p>
<p>For negative lags, <span class="math display">\[
\hat\gamma_{xy}(-h) = \hat\gamma_{yx}(h).
\]</span></p>
<p><br></p>
<div class="fragment">
<p>The <strong>sample cross-correlation function</strong> is</p>
<p><span class="math display">\[
\hat\rho_{xy}(h)
=
\frac{\hat\gamma_{xy}(h)}
{\sqrt{\hat\gamma_x(0)\,\hat\gamma_y(0)}}.
\]</span></p>
</div>
<p><br></p>
<div class="fragment">
<p>Under white noise benchmark, <span class="math inline">\(\hat \rho_{xy}\)</span> is normal with mean zero and</p>
<p><span class="math display">\[
\sigma_{\hat \rho_{xy}} = \frac{1}{\sqrt{n}}
\]</span> if at least one of the processes is independent white noise.</p>
</div>
</section>
<section id="example-soi-and-recruitment" class="level2">
<h2 class="anchored" data-anchor-id="example-soi-and-recruitment">Example: SOI and Recruitment</h2>
<div id="60508b91" class="cell" data-fig-height="5" data-execution_count="7">
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="unit1_files/figure-html/cell-8-output-1.png" class="quarto-figure quarto-figure-center figure-img" width="420" height="420"></p>
</figure>
</div>
</div>
</div>
<p><br></p>
<ul>
<li>SOI: a climate index that summarizes the state of the El Niño–La Niña cycle, which strongly affects ocean conditions and marine ecosystems.</li>
<li>Recruitment: number of young fish that survive to enterthe population<br>
</li>
<li>Negative lags: SOI leads Recruitment</li>
</ul>
</section>
<section id="section" class="level2">
<h2 class="anchored" data-anchor-id="section"></h2>
<section id="can-we-interpret-the-sample-ccf-as-evidence-of-dependence" class="level3 centered">
<h3 class="anchored" data-anchor-id="can-we-interpret-the-sample-ccf-as-evidence-of-dependence"><span style="font-size:1.3em;"><em>Can we interpret the sample CCF as evidence of dependence?</em></span></h3>
</section>
</section>
<section id="not-really" class="level2">
<h2 class="anchored" data-anchor-id="not-really">Not Really…</h2>
<p><strong>Null hypothesis</strong></p>
<p><span class="math display">\[
H_0:\quad \gamma_{xy}(h) = 0 \quad \text{for all } h
\]</span></p>
<p><br></p>
<p><strong>Alternative hypothesis</strong></p>
<p><span class="math display">\[
H_1:\quad \gamma_{xy}(h) \neq 0 \quad \text{for some } h
\]</span></p>
<p><br></p>
<div class="fragment">
<p>The dashed lines <span class="math inline">\(\pm 2/\sqrt{n}\)</span> provide a valid reference <strong>only if at least one of the series is independent white noise</strong>.</p>
<p>Since neither series here is white noise, this benchmark does <strong>not</strong> apply.</p>
<p>The pparent peaks in the sample CCF may reflect <strong>spurious dependence</strong> induced by serial correlation within each series.</p>
</div>
</section>
<section id="spurious-cross-correlation-and-prewhitening" class="level2">
<h2 class="anchored" data-anchor-id="spurious-cross-correlation-and-prewhitening">Spurious Cross-Correlation and Prewhitening</h2>
<ul>
<li>Simulate two independent series:</li>
</ul>
<p><span class="math display">\[
x_t = 2\cos\left(\frac{2\pi t}{12}\right) + \varepsilon_t,
\qquad
y_t = 2\cos\left(\frac{2\pi (t+5)}{12}\right) + \eta_t,
\]</span></p>
<div class="fragment">
<div id="e7a9ac93" class="cell" data-fig-height="7" data-execution_count="8">
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="unit1_files/figure-html/cell-9-output-1.png" class="quarto-figure quarto-figure-center figure-img" width="420" height="420"></p>
</figure>
</div>
</div>
</div>
</div>
<p><br></p>
<div class="fragment">
<p><strong>Prewhitening</strong>: remove predictable serial structure from one series. Here, the seasonal component of <span class="math inline">\(y_t\)</span>, i.e.&nbsp;regress on <span class="math inline">\(cos(2 \pi t / 12)\)</span> and <span class="math inline">\(sin(2 \pi t / 12)\)</span>.</p>
</div>
<div class="fragment">
<ul>
<li><p>In practice, the serial dependence structure of the data is unknown.</p></li>
<li><p>Prewhitening requires specifying and estimating a model to remove this dependence.</p></li>
<li><p>Model choice is data-dependent and introduces additional uncertainty that is not accounted for by standard cross-correlation benchmarks, invalidating standard CCF-based inference.</p></li>
<li><p><strong>Takeaway</strong>: cross-correlation analysis is exploratory, and results should be interpreted with a grain of salt.</p></li>
</ul>
</div>
</section>
<section id="vector-valued-series" class="level2">
<h2 class="anchored" data-anchor-id="vector-valued-series">Vector-Valued Series</h2>
<p>In many applications, we are interested in the relationships between <strong>multiple time series</strong>.</p>
<p>Instead of a scalar process <span class="math inline">\(\{X_t\}\)</span>, we consider a <strong>vector-valued process</strong> <span class="math display">\[
\mathbf{X}_t
=
\begin{pmatrix}
X_{1t} \\
X_{2t} \\
\vdots \\
X_{rt}
\end{pmatrix},
\qquad t \in \mathbb{T}.
\]</span></p>
<p>Each component <span class="math inline">\(X_{jt}\)</span> is itself a time series, and dependence may arise</p>
<ul>
<li>over time (within each series),</li>
<li>across components (between series).</li>
</ul>
</section>
<section id="mean-vector-and-covariance-structure" class="level2">
<h2 class="anchored" data-anchor-id="mean-vector-and-covariance-structure">Mean Vector and Covariance Structure</h2>
<p>The <strong>mean vector</strong> is <span class="math display">\[
\boldsymbol{\mu}=\mathbb{E}(\mathbf{X}_t)
=
\begin{pmatrix}
\mathbb{E}(X_{1t}) \\
\mathbb{E}(X_{2t}) \\
\vdots \\
\mathbb{E}(X_{rt})
\end{pmatrix}.
\]</span></p>
<p>The <strong>cross-covariance matrix function</strong> is <span class="math display">\[
\boldsymbol{\Gamma}(h)
=
\mathbb{E}\!\left[(\mathbf{X}_{t+h}-\boldsymbol{\mu})(\mathbf{X}_t-\boldsymbol{\mu})'\right].
\]</span></p>
<p>Its <span class="math inline">\((i,j)\)</span> entry is <span class="math display">\[
\gamma_{ij}(h)=\mathbb{E}\!\left[(\mathbf{X}_{t+h,i}-\boldsymbol{\mu}_i)(\mathbf{X}_{t,j}-\boldsymbol{\mu}_j)\right].
\]</span></p>
<p>Because <span class="math inline">\(\gamma_{ij}(h)=\gamma_{ji}(-h)\)</span>, the matrix satisfies <span class="math display">\[
\boldsymbol{\Gamma}(-h)=\boldsymbol{\Gamma}(h)'.
\]</span></p>
</section>
<section id="sample-covariance-structure" class="level2">
<h2 class="anchored" data-anchor-id="sample-covariance-structure">Sample Covariance Structure</h2>
<p>Let <span class="math inline">\(\mathbf{x}_t = (x_{1t},\ldots,x_{rt})'\)</span> be an observed <span class="math inline">\(r\)</span>-dimensional time series with sample mean</p>
<p><span class="math display">\[
\bar{\mathbf{x}}
=
\frac{1}{n}\sum_{t=1}^n \mathbf{x}_t .
\]</span></p>
<p>The <strong>sample autocovariance matrix</strong> at lag <span class="math inline">\(h\)</span> is defined as</p>
<p><span class="math display">\[
\widehat{\boldsymbol{\Gamma}}(h)
=
\frac{1}{n}
\sum_{t=1}^{n-h}
(\mathbf{x}_{t+h}-\bar{\mathbf{x}})
(\mathbf{x}_t-\bar{\mathbf{x}})' ,
\qquad h = 0,1,\ldots,n-1.
\]</span></p>
<p>For negative lags, <span class="math display">\[
\widehat{\boldsymbol{\Gamma}}(-h)
=
\widehat{\boldsymbol{\Gamma}}(h)' .
\]</span></p>
<p>The <span class="math inline">\((i,j)\)</span> entry of <span class="math inline">\(\widehat{\boldsymbol{\Gamma}}(h)\)</span> is the sample cross-covariance between <span class="math inline">\(x_{i,t+h}\)</span> and <span class="math inline">\(x_{j,t}\)</span>.</p>
</section>
<section id="a-brief-digression-multidimensional-series" class="level2">
<h2 class="anchored" data-anchor-id="a-brief-digression-multidimensional-series">A Brief Digression: Multidimensional Series</h2>
<ul>
<li><p>So far, we have studied <strong>time series</strong>: a stochastic process indexed by time, with scalar or vector values.</p></li>
<li><p>More generally, a stochastic process can be indexed by <strong>multiple dimensions</strong>.</p></li>
</ul>
<p><br></p>
<div class="fragment">
<p>Example: <strong>Soil surface temperature</strong> measured on a spatial grid.</p>
<p>Let <span class="math inline">\(x_{s_1,s_2}\)</span> denote soil surface temperature at grid location <span class="math inline">\((s_1,s_2)\)</span>.</p>
<ul>
<li>Index: spatial location <span class="math inline">\((s_1,s_2)\)</span><br>
</li>
<li>Value: temperature (scalar)</li>
</ul>
<p>This defines a <strong>spatial stochastic process</strong></p>
<p><span class="math display">\[
\{ x_s : s \in \mathbb{Z}^2 \}.
\]</span></p>
</div>
</section>
<section id="soil-surface-temperatures" class="level2">
<h2 class="anchored" data-anchor-id="soil-surface-temperatures">Soil Surface Temperatures</h2>
<div id="0d577cec" class="cell" data-fig-height="6.8" data-execution_count="9">
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="unit1_files/figure-html/cell-10-output-1.png" class="quarto-figure quarto-figure-center figure-img" width="420" height="420"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="multidimensional-autocovariance" class="level2">
<h2 class="anchored" data-anchor-id="multidimensional-autocovariance">Multidimensional Autocovariance</h2>
<p>The <strong>multidimensional autocovariance function</strong> is defined as <span class="math display">\[
\gamma(\mathbf{h})
=
\mathbb{E}\!\left[
(x_{\mathbf{s}+\mathbf{h}}-\mu)(x_{\mathbf{s}}-\mu)
\right],
\]</span> where <span class="math display">\[
\mathbf{h} = (h_1, h_2, \ldots, h_r)
\]</span> is a vector of lags in each dimension.</p>
<p><br></p>
<div class="fragment">
<p>For a <strong>two-dimensional</strong> process (rows and columns), <span class="math display">\[
\gamma(h_1, h_2)
=
\mathbb{E}\!\left[
(x_{s_1+h_1,\, s_2+h_2}-\mu)
(x_{s_1,\, s_2}-\mu)
\right].
\]</span></p>
<p>The autocovariance depends on <strong>spatial displacement</strong>, not absolute location.</p>
</div>
<p><br></p>
<div class="fragment">
<p>The <strong>sample autocovariance function</strong> is</p>
<p><span class="math display">\[
\hat{\gamma}(h_1,h_2)
=
\frac{1}{S_1 S_2}
\sum_{s_1=1}^{S_1-h_1}
\sum_{s_2=1}^{S_2-h_2}
(x_{s_1+h_1,\;s_2+h_2}-\bar{x})
(x_{s_1,\;s_2}-\bar{x}),
\]</span></p>
<p>where the <strong>sample mean</strong> is</p>
<p><span class="math display">\[
\bar{x}
=
\frac{1}{S_1 S_2}
\sum_{s_1=1}^{S_1}
\sum_{s_2=1}^{S_2}
x_{s_1,s_2}.
\]</span></p>
</div>
<p><br></p>
<div class="fragment">
<p>The <strong>sample autocorrelation function</strong> is</p>
<p><span class="math display">\[
\hat{\rho}(h_1,h_2)
=
\frac{\hat{\gamma}(h_1,h_2)}{\hat{\gamma}(0,0)}.
\]</span></p>
</div>
</section>
<section id="sample-acf-of-soil-temperature" class="level2">
<h2 class="anchored" data-anchor-id="sample-acf-of-soil-temperature">Sample ACF of Soil Temperature</h2>
<div id="d534c8ff" class="cell" data-execution_count="10">
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="unit1_files/figure-html/cell-11-output-1.png" width="420" height="420" class="figure-img"></p>
<figcaption>Two-dimensional autocorrelation function for the soil temperature data.</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="smoothing-in-time-series" class="level2">
<h2 class="anchored" data-anchor-id="smoothing-in-time-series">Smoothing in Time Series</h2>
<section id="moving-average-smoother" class="level3">
<h3 class="anchored" data-anchor-id="moving-average-smoother">Moving average smoother</h3>
<p><span class="math display">\[m_t = \sum_{j=-k}^{k} a_j x_{t-j},\]</span> where <span class="math inline">\(a_j = a_{-j}\)</span> and <span class="math inline">\(\sum_{j=-k}^{k} a_j = 1\)</span> is a symmetric moving average of the data.</p>
<div id="8b770654" class="cell" data-execution_count="11">
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="unit1_files/figure-html/cell-12-output-1.png" class="quarto-figure quarto-figure-center figure-img" width="420" height="420"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="smoothing-in-time-series-1" class="level2">
<h2 class="anchored" data-anchor-id="smoothing-in-time-series-1">Smoothing in Time Series</h2>
<section id="kernel-smoothing" class="level3">
<h3 class="anchored" data-anchor-id="kernel-smoothing">Kernel smoothing</h3>
<p><span class="math display">\[
m_t
=
\sum_{i=1}^{n} w_i(t)\, x_i, \quad w_i(t)
=
K\!\left(\frac{t - i}{b}\right)
\Big/
\sum_{j=1}^{n} K\!\left(\frac{t - j}{b}\right),
\]</span> where <span class="math inline">\(K(\cdot)\)</span> is kernel function, typically the normal kernel <span class="math display">\[
K(z)
=
(2\pi)^{-1/2}\,\exp\!\left(- z^2/2 \right).
\]</span></p>
<div id="b602acee" class="cell" data-execution_count="12">
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="unit1_files/figure-html/cell-13-output-1.png" class="quarto-figure quarto-figure-center figure-img" width="420" height="420"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="smoothing-in-time-series-2" class="level2">
<h2 class="anchored" data-anchor-id="smoothing-in-time-series-2">Smoothing in Time Series</h2>
<section id="lowess-locally-weighted-scatterplot-smoothing" class="level3">
<h3 class="anchored" data-anchor-id="lowess-locally-weighted-scatterplot-smoothing">LOWESS (LOcally WEighted Scatterplot Smoothing)</h3>
<ul>
<li>A local-regression method that uses only <span class="math inline">\(\{x_{t-k/2}, \ldots, x_t, \ldots, x_{t+k/2}\}\)</span> to predict <span class="math inline">\(x_t\)</span>, and then sets <span class="math inline">\(m_t = \hat x_t\)</span></li>
</ul>
<div id="ca7598f3" class="cell" data-execution_count="13">
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="unit1_files/figure-html/cell-14-output-1.png" class="quarto-figure quarto-figure-center figure-img" width="420" height="420"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="smoothing-one-series-as-a-function-of-another" class="level2">
<h2 class="anchored" data-anchor-id="smoothing-one-series-as-a-function-of-another">Smoothing One Series as a Function of Another</h2>
<p>We smooth a scatterplot of <strong>mortality</strong> <span class="math inline">\((M_t)\)</span> as a function of <strong>temperature</strong> <span class="math inline">\((T_t)\)</span> using LOWESS.</p>
<div id="4714b7f3" class="cell" data-fig-height="5.5" data-fig-width="9" data-execution_count="14">
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="unit1_files/figure-html/cell-15-output-1.png" class="quarto-figure quarto-figure-center figure-img" width="420" height="420"></p>
</figure>
</div>
</div>
</div>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>